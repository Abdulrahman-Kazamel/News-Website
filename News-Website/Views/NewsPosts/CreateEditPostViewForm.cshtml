@model NewsPostViewModel
@{
	ViewData["Title"] = Model.Id > 0 ? $"Edit Post : {Model.Title}" : "Create Post";
}

}
<div class="container my-2">
	<div class="card shadow border-0">
		<div class="card-header bg-primary py-3 ">

			<h4 class="mb-0 text-light">@ViewData["Title"]</h4>


		</div>
		<div class="card-body">
			<form asp-action="@(Model.Id > 0 ? "Edit" : "Create" )" method="post" enctype="multipart/form-data">
				@Html.AntiForgeryToken()
				<input type="hidden" asp-for="Id" />
				<div class="form-group mb-3">
					<label asp-for="Title" class="form-label fw-bold"></label>
					<input asp-for="Title" class="form-control" placeholder="Enter post title" />
					<span asp-validation-for="Title" class="text-danger small"></span>
				</div>

				<div class="form-group mb-3">
					<label asp-for="Date" class="form-label fw-bold"></label>
					<input asp-for="Date" type="date" class="form-control" />
					<span asp-validation-for="Date" class="text-danger small"></span>
				</div>

				<div class="form-group mb-3 row justify-content-between">
					<div class=" col-6">
						<label asp-for="File" class="form-label fw-bold"></label>
						<input asp-for="File" type="file"
							   class="form-control"
							   onchange="previewImage(event)" />
						<span asp-validation-for="File" class="text-danger small"></span>
					</div>

					<div class="col-6">
						@* @if (!string.IsNullOrEmpty(Model.Image)) *@

						<img id="imagePreview"
							 src="@(Model.Image != null ? Url.Content("~/assets/img/gallery/" + Model.Image) : "")"
							 class="img-fluid rounded shadow-sm"
							 style="max-height:300px; width:500px;" />


					</div>
				</div>

				<div class="form-group mb-3">
					<label asp-for="CategoryId" class="form-label fw-bold"></label>
					<select asp-for="CategoryId" asp-items="@Model.Categories" class="form-select">
						<option value="">-- Select Category --</option>
					</select>
					<span asp-validation-for="CategoryId" class="text-danger small"></span>
				</div>

				<div class="form-group mb-3">
					<label asp-for="Topic" class="form-label fw-bold"></label>
					<textarea asp-for="Topic" class="form-control" rows="4" placeholder="Write the topic here..."></textarea>
					<span asp-validation-for="Topic" class="text-danger small"></span>
				</div>

				<div class="d-flex justify-content-end">
					<a asp-action="Index" class="btn btn-outline-secondary me-2">Cancel</a>
					<button type="submit" class="btn btn-success">
						<i class="fas fa-save"></i> Save Post
					</button>
				</div>
			</form>
		</div>
	</div>
</div>

@section Scripts {
	@{
		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}


	<script>

			function previewImage(event) {
			const reader = new FileReader();
			reader.onload = function () {
				const img = document.getElementById('imagePreview');
				img.src = reader.result;
			};
			reader.readAsDataURL(event.target.files[0]);
		}


	</script>

}
